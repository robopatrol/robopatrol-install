version: '2'

services:

  robopatrol:
    labels:
      ch.zhaw.description: "Launch robopatrol on a Turtlebot."
    image: robopatrol/webapp
    links:
      - ros-turtlebot:ros
      - server
    ports:
    - "9090:9090"

  robopatrol-simulation:
    labels:
      ch.zhaw.description: "Run robopatrol on a simulated Turtlebot."
    image: robopatrol/webapp
    links:
      - ros-simulation:ros
      - server
    ports:
    - "9090:9090"

# robopatrol-server (REST)
  server:
    image: robopatrol/server
    container_name: robopatrol-server
    ports:
      - "9998:9998"

# robopatrol (ROS Bridge)
  ros-turtlebot:
    image: robopatrol/robopatrol
    container_name: robopatrol 
    command: "/bin/bash -c 'source ./devel/setup.bash && roslaunch robopatrol turtlebot.launch'"
    ports:
      - "9090:9090"
      - "11345:11345"

# robopatrol (ROS Bridge, Gazebo)
  ros-simulation:
    image: robopatrol/robopatrol
    container_name: robopatrol
    ports:
      - "9090:9090"
      - "11311:11311"
      - "11345:11345"